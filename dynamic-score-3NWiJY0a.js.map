{"version":3,"file":"dynamic-score-3NWiJY0a.js","sources":["../src/plugins/dynamic-score.js"],"sourcesContent":["export default hook.define({\n  name: 'Dynamic Score',\n  description: 'Apply dynamic score',\n  contents: [\n    {\n      type: 'config',\n      meta: ['启用动态分数', callback]\n    }\n  ]\n});\nconst { status, stat, app } = hook;\n/**\n * @param {HTMLInputElement} checkbox\n * @param {HTMLDivElement} container\n */\nfunction callback(checkbox, _container) {\n  checkbox.addEventListener('change', () => {\n    if (checkbox.checked) {\n      hook.now.set('dynamic-score', hack);\n    } else {\n      hook.now.delete('dynamic-score');\n    }\n  });\n  status.reg('enable-dynamic-score', checkbox);\n}\nlet lastScore = 0;\nlet nowScore = 0;\nlet dynamicTime = 0;\nfunction hack() {\n  const { numOfNotes } = app.chart;\n  stat.numOfNotes = numOfNotes;\n  if (stat.scoreNum !== nowScore) {\n    lastScore = nowScore;\n    nowScore = stat.scoreNum;\n    dynamicTime = performance.now();\n  }\n  const progress = Math.min(1, (performance.now() - dynamicTime) / 500);\n  stat.numOfNotes /= lastScore / nowScore * (1 - progress) + progress;\n}\n"],"names":["dynamicScore","hook","define","name","description","contents","type","meta","checkbox","_container","addEventListener","checked","now","set","hack","delete","status","reg","stat","app","lastScore","nowScore","dynamicTime","numOfNotes","chart","scoreNum","performance","progress","Math","min"],"mappings":"AAAA,MAAeA,EAAAC,KAAKC,OAAO,CACzBC,KAAM,gBACNC,YAAa,sBACbC,SAAU,CACR,CACEC,KAAM,SACNC,KAAM,CAAC,SASb,SAAkBC,EAAUC,GAC1BD,EAASE,iBAAiB,UAAU,KAC9BF,EAASG,QACXV,KAAKW,IAAIC,IAAI,gBAAiBC,GAE9Bb,KAAKW,IAAIG,OAAO,gBAAe,IAGnCC,EAAOC,IAAI,uBAAwBT,EACrC,QAdQQ,OAAAA,EAAQE,KAAAA,EAAMC,IAAAA,GAAQlB,KAe9B,IAAImB,EAAY,EACZC,EAAW,EACXC,EAAc,EAClB,SAASR,IACP,MAAQS,WAAAA,GAAeJ,EAAIK,MAC3BN,EAAKK,WAAaA,EACdL,EAAKO,WAAaJ,IACpBD,EAAYC,EACZA,EAAWH,EAAKO,SAChBH,EAAcI,YAAYd,OAEtBe,MAAAA,EAAWC,KAAKC,IAAI,GAAIH,YAAYd,MAAQU,GAAe,KACjEJ,EAAKK,YAAcH,EAAYC,GAAY,EAAIM,GAAYA,CAC7D"}